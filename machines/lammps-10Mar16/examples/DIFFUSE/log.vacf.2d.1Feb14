LAMMPS (12 Feb 2014)
# sample LAMMPS input script for diffusion of 2d LJ liquid
# mean-squared displacement via compute msd

# settings

variable	x equal 40
variable	y equal 40

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox block 0 $x 0 $y -0.1 0.1
region          simbox block 0 40 0 $y -0.1 0.1
region          simbox block 0 40 0 40 -0.1 0.1
create_box      1 simbox
Created orthogonal box = (0 0 -0.182574) to (73.0297 73.0297 0.182574)
  4 by 2 by 1 MPI processor grid
create_atoms    1 box
Created 3200 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Memory usage per processor = 2.06238 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0   -0.5652325   -1.5346995 
    1000   0.97537833   -1.5723957            0   -0.5973222   0.92877783 
    2000   0.99008371   -1.5748206            0  -0.58504633    1.0809416 
    3000    1.0111412   -1.5848987            0  -0.57407352    1.0174297 
    4000    1.0055417   -1.5857581            0  -0.58053054   0.95647691 
    5000   0.97069909   -1.5851114            0  -0.61471562   0.90108296 
Loop time of 0.556362 on 8 procs for 5000 steps with 3200 atoms

Pair  time (%) = 0.242478 (43.5828)
Neigh time (%) = 0.0590148 (10.6073)
Comm  time (%) = 0.0862918 (15.51)
Outpt time (%) = 0.000148952 (0.0267725)
Other time (%) = 0.168428 (30.2731)

Nlocal:    400 ave 406 max 394 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Nghost:    202.5 ave 212 max 191 min
Histogram: 1 0 0 0 3 1 0 2 0 1
Neighs:    2800.88 ave 2903 max 2690 min
Histogram: 1 1 0 0 1 2 1 0 1 1

Total # of neighbors = 22407
Ave neighs/atom = 7.00219
Neighbor list builds = 599
Dangerous builds = 0

unfix		2

# data gathering run

reset_timestep  0

compute         vacf all vacf
fix             4 all ave/time 1 1 1 c_vacf[4] #file tmp.vacf

# factor of 0.5 is for 2d

fix             5 all vector 1 c_vacf[4]
variable        vacf equal 0.5*dt*trap(f_5)

thermo_style	custom step temp c_vacf[4] v_vacf

# only need to run for 10K steps to make a good 100-frame movie

#dump	        1 all custom 1 tmp.dump id type vx vy vz

#dump		2 all image 100 image.*.jpg type type zoom 1.6 adiam 1.2

thermo          1000
run	        100000
Memory usage per processor = 2.29126 Mbytes
Step Temp vacf[4] vacf 
       0   0.97069909    1.9407915            0 
    1000   0.98259938  0.068345562   0.21424576 
    2000   0.98866167  0.028205164   0.24370013 
    3000   0.98066292  0.008852823   0.27439588 
    4000   0.97384109  0.011903564    0.3159275 
    5000   0.97843004  0.019295534   0.33596598 
    6000   0.98703537   0.01070801   0.34517088 
    7000   0.97169186 -0.0082938435   0.33784119 
    8000    0.9823893  0.038402174   0.32756669 
    9000    0.9998457  0.045317593   0.33379383 
   10000   0.98782869  0.027148675   0.34751149 
   11000   0.99481941  0.035783937   0.36009047 
   12000    0.9760981 -0.0010825507   0.36059769 
   13000   0.97774297  0.048323885   0.36103752 
   14000   0.96752038 0.0008189784   0.34988029 
   15000   0.98697717   -0.0339338   0.35841003 
   16000   0.98385955   0.03729417   0.36378228 
   17000    0.9839555 -0.0063931744   0.37486488 
   18000   0.98000182  0.065439765   0.39975619 
   19000   0.96633821 0.0034363237   0.39585239 
   20000   0.98641362    -0.020284   0.39696422 
   21000    0.9763779  0.013683539   0.36183593 
   22000   0.97984221 -0.0077108606   0.32642476 
   23000   0.98384014 -0.030550764   0.32775468 
   24000   0.97601102 -0.0047287909    0.3294707 
   25000   0.99623187   0.00653461   0.34586445 
   26000   0.98943691  -0.05047279    0.3283058 
   27000   0.98992058  -0.01720223   0.30840611 
   28000   0.97957751  0.020915942    0.3149002 
   29000   0.99513582   0.03712206   0.30525251 
   30000   0.99754125 -0.022509889   0.29511243 
   31000   0.98894929  0.015289267   0.25586423 
   32000     0.973493  0.015971435   0.25226411 
   33000   0.99989261  0.026989142   0.29050941 
   34000   0.97192218  0.043710515   0.29067058 
   35000   0.99711642  0.047231436   0.27989734 
   36000   0.97718259 0.0059969847   0.28843181 
   37000   0.98194807  0.017440303   0.30325718 
   38000   0.97195138 -0.040449666   0.29696592 
   39000   0.98219017 0.0063692991   0.28915832 
   40000   0.98039694 -0.0038122219   0.24799014 
   41000   0.97621359  0.012624961    0.2374766 
   42000   0.97460413   -0.0024187   0.24693474 
   43000    0.9799912  0.015928618   0.26238505 
   44000   0.96313376 -0.067284605   0.24397772 
   45000   0.97643796 -0.0039001998   0.22733962 
   46000   0.98641729 -0.026949085   0.24167989 
   47000   0.97811939 -0.050859011    0.2335985 
   48000   0.99744864 -0.008154229    0.2417371 
   49000   0.97480356 -0.011051498   0.25474033 
   50000   0.97841509  -0.00531423   0.25357072 
   51000   0.97865859  0.067722096   0.25086864 
   52000   0.97415415  0.015863025    0.2516842 
   53000   0.97984491  0.021332829   0.28226376 
   54000   0.99289379   -0.0192578   0.28300764 
   55000   0.98606668  0.029307891   0.27592186 
   56000   0.98585489 0.0062922121    0.2687204 
   57000   0.98507959 -0.0068688582   0.27868708 
   58000   0.98030805  0.013766115   0.31008116 
   59000   0.98315137  0.033068034   0.32211415 
   60000   0.98762585  0.050662295   0.30109082 
   61000   0.96937507  -0.02797113   0.29968066 
   62000   0.97194792 -0.0032022157    0.2866526 
   63000   0.99877655 -0.010154313   0.31701083 
   64000   0.98525211 -0.020415497   0.31774092 
   65000    0.9833149 0.0087192442   0.31256891 
   66000   0.97191797 0.0047184494   0.29880531 
   67000   0.98479592 -0.010779275     0.294197 
   68000   0.98418943 -0.035264623   0.29993828 
   69000   0.96953928 -0.028114432   0.27403611 
   70000   0.98373337 -0.057363336   0.25554163 
   71000   0.98260952  0.048742037   0.27102884 
   72000   0.98906053  0.010799224   0.26908376 
   73000   0.99569597 -0.0092675754   0.26927752 
   74000   0.97627362  0.013945821    0.2730712 
   75000   0.97276792  0.015036012   0.25847255 
   76000   0.97659072 -0.027078556   0.26783118 
   77000    0.9807196 -0.044553679   0.25993053 
   78000   0.97398601 -0.00027444729   0.26127735 
   79000   0.98124212 -0.012488833   0.27454966 
   80000   0.98506783 -0.015190822    0.2676633 
   81000   0.97926561 -0.012755191   0.27046398 
   82000   0.97906184  0.012564185    0.2835038 
   83000   0.96540502 -0.007372877   0.29622738 
   84000   0.98726761  0.021015365   0.32432233 
   85000   0.98133061  0.020043402    0.3540913 
   86000   0.99142106  0.025350024   0.36697674 
   87000   0.97917566 0.0061562414   0.37456288 
   88000   0.99391197 0.0068565008   0.39150922 
   89000   0.98521911  0.015500816   0.38121119 
   90000   0.97419059 0.00037609894   0.34181128 
   91000   0.98687774 -0.0073221495   0.35316892 
   92000   0.97816545  0.014057005   0.33181146 
   93000   0.98734859  0.016570523   0.34546487 
   94000   0.99116168 -0.0068196043   0.36316635 
   95000   0.99982024  0.076723346   0.38376316 
   96000   0.99232404 -0.048534983   0.38369657 
   97000   0.97829693 0.0041180664   0.38022523 
   98000   0.99878715 -0.00089133295   0.40289006 
   99000   0.97026354 -0.0039532716   0.43650647 
  100000   0.98911409  0.028647976    0.4499919 
Loop time of 10.5771 on 8 procs for 100000 steps with 3200 atoms

Pair  time (%) = 4.88134 (46.1499)
Neigh time (%) = 1.2657 (11.9664)
Comm  time (%) = 1.78371 (16.8638)
Outpt time (%) = 0.0207323 (0.196011)
Other time (%) = 2.62565 (24.8239)

Nlocal:    400 ave 410 max 389 min
Histogram: 1 1 1 0 1 1 0 0 1 2
Nghost:    205.375 ave 216 max 194 min
Histogram: 1 0 0 2 2 0 1 0 0 2
Neighs:    2818 ave 3010 max 2683 min
Histogram: 2 0 2 0 1 1 0 1 0 1

Total # of neighbors = 22544
Ave neighs/atom = 7.045
Neighbor list builds = 12748
Dangerous builds = 0
