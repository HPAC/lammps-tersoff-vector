LAMMPS (1 Feb 2014)
# sample LAMMPS input script for viscosity of 2d LJ liquid
# NEMD via fix deform and fix nvt/sllod

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable	srate equal 2.7

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

# problem setup

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox prism 0 $y 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 20 -0.1 0.1 0.0 0.0 0.0
create_box      1 simbox
Created triclinic box = (0 0 -0.182574) to (36.5148 36.5148 0.182574) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 800 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Memory usage per processor = 2.06394 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0     -0.56617    -1.535262 
    1000    0.9455393    -1.573329            0  -0.62897162   0.91884199 
    2000    1.0359047   -1.6229551            0  -0.58834528   0.96136682 
    3000    1.0171488   -1.5468681            0  -0.53099077    1.1078235 
    4000    1.0040221   -1.5977142            0  -0.59494717   0.92428924 
    5000   0.95883045   -1.6087309            0  -0.65109902   0.92015627 
Loop time of 0.897984 on 1 procs for 5000 steps with 800 atoms

Pair  time (%) = 0.464335 (51.7087)
Neigh time (%) = 0.13359 (14.8767)
Comm  time (%) = 0.0208902 (2.32635)
Outpt time (%) = 5.31673e-05 (0.00592074)
Other time (%) = 0.279115 (31.0824)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    266 ave 266 max 266 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5604 ave 5604 max 5604 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5604
Ave neighs/atom = 7.005
Neighbor list builds = 548
Dangerous builds = 0

unfix  	        1
unfix		2

# turn on NEMD shear and equilibrate some more

velocity	all scale $t
velocity	all scale 1

variable	xyrate equal ${srate}/lx
variable	xyrate equal 2.7/lx

fix		1 all nvt/sllod temp $t $t 0.1
fix		1 all nvt/sllod temp 1 $t 0.1
fix		1 all nvt/sllod temp 1 1 0.1
fix		2 all deform 1 xy erate ${xyrate} remap v
fix		2 all deform 1 xy erate 0.0739425452631974 remap v
fix		4 all ave/spatial 20 250 5000 y center 0.05 vx 		  units reduced file profile.nemd.2d

compute		usual all temp
compute		tilt all temp/deform

thermo          1000
thermo_style	custom step temp c_usual epair etotal press pxy
thermo_modify	temp tilt
run		50000
Memory usage per processor = 2.06486 Mbytes
Step Temp usual E_pair TotEng Press Pxy 
    5000    2.2074694            1   -1.6087309   0.59597912    1.6684032  -0.13173614 
    6000   0.92758142    1.0829648   -1.6587109    -0.732289   0.69434408 -0.040395721 
    7000   0.95692582    1.2000988   -1.7242343  -0.76850461   0.58119159 -0.078038652 
    8000    1.0214774     1.223802   -1.6519928  -0.63179227   0.74285068  -0.10278761 
    9000    1.0293091    1.3122841   -1.6684363  -0.64041383   0.90722071  -0.19178365 
   10000    1.0445241    1.3788798   -1.6688897  -0.62567124   0.71535783 -0.086951926 
   11000    1.0023372     1.362187   -1.6622117  -0.66112741   0.71746537  -0.18121663 
   12000   0.95256804     1.379025   -1.6574208  -0.70604349   0.57745775 -0.040719788 
   13000    1.0318148    1.4597155   -1.6433202  -0.61279515   0.65027764 -0.093427737 
   14000    1.0332344    1.4031097   -1.6290961  -0.59715319   0.90536763 0.0020682054 
   15000    1.0277172    1.5207267   -1.6221988  -0.59576627   0.84609392 -0.0074794989 
   16000   0.99207101    1.5017016   -1.6247974  -0.63396649   0.92606954  -0.10188984 
   17000   0.96488503    1.4793873    -1.600228  -0.63654911   0.89923523  -0.14261301 
   18000   0.99547475    1.5236224    -1.635473  -0.64124255   0.68307708  -0.25098795 
   19000    1.0323664    1.5855445   -1.6227003  -0.59162439   0.94072356  -0.09360683 
   20000    1.0180092    1.5842966   -1.6143642  -0.59762743   0.93103828  0.040342848 
   21000    1.0254077    1.6283785   -1.6301278  -0.60600186   0.87479869  0.044804621 
   22000   0.97172908    1.5990643   -1.6486056  -0.67809118   0.76887644  0.037405021 
   23000   0.97049676    1.6076804   -1.6058839  -0.63660024   0.93367017 -0.024871417 
   24000    1.0026729    1.6776495    -1.622805  -0.62138548    0.8635542 -0.038997148 
   25000    0.9633361    1.6349825   -1.6404336  -0.67830169   0.76001017   -0.1311218 
   26000    1.0001388    1.6907443   -1.6004823  -0.60159366   0.81806855  -0.18349721 
   27000   0.94191819    1.6384271   -1.5965443  -0.65580352   0.95785507 -0.086102432 
   28000    1.0108584     1.731468   -1.6463325  -0.63673767   0.74516073  -0.19911341 
   29000    1.0138048    1.7289581   -1.6000006  -0.58746311   0.94740326  0.016609077 
   30000    1.0050557    1.7572204    -1.599182  -0.59538264    0.8223186  -0.24136602 
   31000    1.0344558    1.7783254   -1.6122236  -0.57906086    1.1734714  -0.23484979 
   32000    1.0174318    1.8509241   -1.5854329  -0.56927295   0.81903748 -0.096360108 
   33000    1.0052704    1.7954794   -1.6076165  -0.60360266   0.98062712  -0.23179974 
   34000    1.0138726    1.7784382   -1.6535717  -0.64096651   0.79928063    -0.184148 
   35000    1.0108265    1.7715149   -1.5944308  -0.58486783     0.999611  -0.11864672 
   36000   0.98516241    1.7509661   -1.6285996  -0.64466861   0.94523235  -0.13010197 
   37000     0.971965    1.7638125   -1.5746851  -0.60393507    1.2265617 -0.077584507 
   38000   0.93549343    1.8078749   -1.5840479  -0.64972382    1.0484769  0.031083799 
   39000    1.0416402    1.8705987   -1.5799828  -0.53964462   0.94816785 -0.0034475262 
   40000   0.96016973     1.856959   -1.5958952  -0.63692565   0.94610429  -0.18285492 
   41000    1.0051478    1.8962677   -1.5860155  -0.58212412    1.0946382 -0.068521999 
   42000    1.0081883    1.8593802   -1.6072469   -0.6003189   0.94320687 -0.041090231 
   43000   0.98432329    1.8786095   -1.5924866  -0.60939372    1.0486461  -0.12281617 
   44000    1.0262999    1.9116758   -1.5900042  -0.56498711    1.1223199  0.018952448 
   45000   0.96577584    1.8870562   -1.6252423  -0.66067367   0.96036779 0.0028994584 
   46000    1.0245911    1.9444906    -1.613004  -0.58969369   0.99363465 -0.021819492 
   47000   0.93381748    1.8446233   -1.5772527  -0.64460252    1.0674773  -0.11978723 
   48000   0.97729437    1.8717878   -1.5711485  -0.59507573    1.1563358  -0.25770589 
   49000    1.0354354     1.987001   -1.6136701  -0.57952894   0.88244264  0.096378234 
   50000    1.0094924    1.9808787    -1.612573  -0.60434244   0.94984417  -0.11436064 
   51000     1.027174    1.9461247   -1.5899623   -0.5640723    1.0198367  0.065037899 
   52000    1.0281396     2.019881   -1.6005519  -0.57369755    1.0350175 -0.057470252 
   53000     1.018099    2.0455373   -1.6308565   -0.6140301   0.98344621 -0.095749654 
   54000    1.0378532    2.0621046   -1.6137201   -0.5771642   0.92484803  -0.20897708 
   55000   0.94998276    1.9258606   -1.5946282   -0.6458329    1.0304527 -0.061356231 
Loop time of 11.8921 on 1 procs for 50000 steps with 800 atoms

Pair  time (%) = 4.938 (41.5235)
Neigh time (%) = 2.88697 (24.2764)
Comm  time (%) = 0.342039 (2.87619)
Outpt time (%) = 0.00175095 (0.0147236)
Other time (%) = 3.72331 (31.3092)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    286 ave 286 max 286 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5610 ave 5610 max 5610 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5610
Ave neighs/atom = 7.0125
Neighbor list builds = 11310
Dangerous builds = 0

# data gathering run

variable	visc equal -pxy/(v_srate/ly)
fix		vave all ave/time 10 100 1000 v_visc ave running start 56000

thermo_style	custom step temp press pxy v_visc f_vave
WARNING: New thermo_style command, previous thermo_modify settings will be lost (../output.cpp:665)
thermo_modify	temp tilt

# only need to run for 5400 steps to make a good 100-frame movie
# set 54K steps above in equil and 5400 here simply to make good movie
# 54K and 5400 are multiples of box-swap periodicity = 2700 steps

#dump	        1 all custom 50 dump.nemd.2d id type x y z vx

#dump		1 all image 50 image.*.jpg vx type zoom 1.2 adiam 1.2
#dump_modify	1 pad 5 amap 0.0 ${srate} ca 0.0 2 min blue max red

run		50000
Memory usage per processor = 2.10508 Mbytes
Step Temp Press Pxy visc vave 
   55000   0.94998276    1.0303592 -0.063500962   0.85878789            0 
   56000    1.0301515    1.0617767  -0.10024411    1.3557027    1.2310718 
   57000    1.0250473    1.0794382  -0.32669382    4.4182117    1.2359148 
   58000   0.98594086    1.1283437    0.0380247  -0.51424657      1.30918 
   59000    1.0164723    1.0980255 -0.069171978   0.93548279    1.3260744 
   60000    1.0711985    1.1230358    -0.125773    1.7009558    1.3414067 
   61000   0.98932053    0.9807511  -0.15097335    2.0417657    1.3671221 
   62000     0.998341   0.81153573 -0.020326294   0.27489307    1.3670784 
   63000    1.0718254    1.1974744   -0.1580162    2.1370132    1.3213502 
   64000    1.0057042    1.0230065  0.034014907  -0.46001807    1.3316618 
   65000    1.0040774    1.0303633 -0.078600273    1.0629912    1.3072524 
   66000    1.0382782   0.93946231 -0.043423028   0.58725363    1.2837103 
   67000    1.0226248   0.98900989 -0.054099059   0.73163642     1.253851 
   68000   0.96605035    1.2060528  0.011937095  -0.16143744    1.2420174 
   69000    1.0326968    1.0489439 -0.055891469   0.75587699    1.2551535 
   70000   0.98367121   0.87910603  -0.16249968    2.1976479    1.2607276 
   71000      1.02139    1.0729641  0.014510511  -0.19624035    1.2555329 
   72000   0.95586405   0.82121701  0.016186091  -0.21890092    1.2511372 
   73000    1.0422537    0.8674772  0.029604958  -0.40037786    1.2700259 
   74000    1.0249336    1.0985439  -0.13831417    1.8705627    1.2656874 
   75000   0.98213321   0.88865968  0.045972743  -0.62173601    1.2577007 
   76000    0.9397546   0.71322157 -0.060283057   0.81526889    1.2699146 
   77000    1.0063205    1.0310471 -0.065558372   0.88661232    1.2675723 
   78000   0.96815308    1.1257553  0.025044943  -0.33870816     1.258244 
   79000     1.039923    1.1557001  -0.16485925    2.2295587    1.2397555 
   80000    1.0203604   0.88432557 -0.096887682    1.3103103    1.2385055 
   81000    0.9504362   0.98117588 -0.078463955    1.0611476    1.2476425 
   82000    0.9959177    1.1195113 -0.013058798   0.17660736    1.2360316 
   83000    1.0001019   0.90295804  -0.26432373    3.5747177    1.2339827 
   84000    1.0173461   0.84946561   0.12193823   -1.6490943    1.2473019 
   85000    1.0325527    1.0523874  0.030626506  -0.41419329    1.2440578 
   86000   0.94990925    1.0851851  -0.28324305    3.8305829    1.2410903 
   87000    1.0408269    1.2359016  -0.07443383    1.0066441    1.2404526 
   88000    1.0006532   0.92603737  -0.20524087    2.7756803    1.2439314 
   89000   0.99846847   0.94779421 -0.047328236   0.64006771    1.2443818 
   90000   0.98628639    1.0536216  -0.15876739    2.1471724    1.2354671 
   91000   0.99478876    1.0885053  -0.17485734    2.3647731    1.2249337 
   92000    1.0423662   0.95712108  -0.13839217    1.8716176    1.2276722 
   93000   0.99308815    1.1868657  -0.13322814    1.8017792    1.2254173 
   94000    0.9835718   0.98339544  -0.10768988    1.4563994     1.224888 
   95000   0.94438219   0.97622034 -0.068799681   0.93044784    1.2204198 
   96000    1.0142012    0.9210571  -0.14001612    1.8935799     1.217945 
   97000   0.99678643    1.2773861 -0.091691808    1.2400413    1.2063637 
   98000   0.96852646   0.89124039  -0.28173744     3.810221     1.203252 
   99000   0.97030968    1.0148935  -0.11717859    1.5847249    1.2020913 
  100000   0.97709835    1.0314408  -0.16108012    2.1784497    1.2019234 
  101000   0.97653875    1.1948328 -0.085456884    1.1557201    1.2026873 
  102000   0.97469158    1.0508677 -0.062662919   0.84745418    1.2062227 
  103000   0.99620509   0.96826158  -0.10181244    1.3769128      1.20325 
  104000   0.98933536    1.0077017  -0.18015152    2.4363717    1.1999909 
  105000   0.99627299   0.93278548 -0.099781319    1.3494439    1.2018992 
Loop time of 12.3598 on 1 procs for 50000 steps with 800 atoms

Pair  time (%) = 5.02156 (40.6281)
Neigh time (%) = 3.14134 (25.4158)
Comm  time (%) = 0.36303 (2.93718)
Outpt time (%) = 0.00100946 (0.00816731)
Other time (%) = 3.83288 (31.0108)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    256 ave 256 max 256 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5616 ave 5616 max 5616 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5616
Ave neighs/atom = 7.02
Neighbor list builds = 12247
Dangerous builds = 0
