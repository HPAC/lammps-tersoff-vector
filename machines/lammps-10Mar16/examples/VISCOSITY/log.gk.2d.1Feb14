LAMMPS (1 Feb 2014)
# sample LAMMPS input script for viscosity of 2d LJ liquid
# Green-Kubo method via fix ave/correlate

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable    p equal 400     # correlation length
variable    s equal 5       # sample interval
variable    d equal $p*$s   # dump interval
variable    d equal 400*$s   
variable    d equal 400*5   

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox block 0 $x 0 $y -0.1 0.1
region          simbox block 0 20 0 $y -0.1 0.1
region          simbox block 0 20 0 20 -0.1 0.1
create_box      1 simbox
Created orthogonal box = (0 0 -0.182574) to (36.5148 36.5148 0.182574)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 800 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

# equilibration run

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

thermo          $d
thermo          2000
run	        10000
Memory usage per processor = 2.06394 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0     -0.56617    -1.535262 
    2000    1.0164992   -1.6006146            0  -0.58538603   0.88642098 
    4000    1.0955206   -1.6156387            0  -0.52148756   0.94410568 
    6000    1.0384043   -1.6029205            0   -0.5658142   0.82862869 
    8000    1.0288194   -1.5760462            0  -0.54851284    1.1299693 
   10000   0.97521893   -1.5752855            0  -0.60128557    1.0982639 
Loop time of 1.72441 on 1 procs for 10000 steps with 800 atoms

Pair  time (%) = 0.929897 (53.9255)
Neigh time (%) = 0.203868 (11.8225)
Comm  time (%) = 0.0357857 (2.07524)
Outpt time (%) = 5.60284e-05 (0.00324913)
Other time (%) = 0.554805 (32.1736)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    261 ave 261 max 261 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5617 ave 5617 max 5617 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5617
Ave neighs/atom = 7.02125
Neighbor list builds = 1101
Dangerous builds = 0

velocity	all scale $t
velocity	all scale 1

unfix		2

# Green-Kubo viscosity calculation

reset_timestep  0

variable         pxy equal pxy

fix              SS all ave/correlate $s $p $d                  v_pxy type auto file profile.gk.2d ave running
fix              SS all ave/correlate 5 $p $d                  v_pxy type auto file profile.gk.2d ave running
fix              SS all ave/correlate 5 400 $d                  v_pxy type auto file profile.gk.2d ave running
fix              SS all ave/correlate 5 400 2000                  v_pxy type auto file profile.gk.2d ave running

variable         scale equal 1.0/$t*vol*$s*dt
variable         scale equal 1.0/1*vol*$s*dt
variable         scale equal 1.0/1*vol*5*dt
variable         v11 equal trap(f_SS[3])*${scale}
variable         v11 equal trap(f_SS[3])*33.3333333333333

thermo_style     custom step temp press pxy v_v11

run              500000
Memory usage per processor = 2.06394 Mbytes
Step Temp Press Pxy v11 
       0            1    1.1131139 -0.062970733  0.066088554 
    2000    1.0080895    1.0200888  -0.11243616   -1.2606591 
    4000   0.99653513    1.0745982 -0.0075361431   -1.2260153 
    6000     1.015614    1.0288859 -0.045052789    2.2423387 
    8000    1.0480587    1.0090528  -0.16941968    1.4483022 
   10000    1.0340413    0.8935734 -0.016265599     1.367264 
   12000    1.0208142   0.98827028 -0.098494798   0.96391762 
   14000    1.0063108    1.1900869  0.041555635   0.71920668 
   16000    1.0104133    1.0341648  -0.08539107   0.87216885 
   18000    1.0324239   0.78956816 -0.022393354   0.99812938 
   20000   0.98065939    1.1290253  0.088823616   0.86856675 
   22000    1.0456522   0.79585972  -0.10649734    1.3811196 
   24000    1.0120651    1.0552123   0.21725489     1.648588 
   26000    1.0441983     0.959829 0.0053239549    1.6192642 
   28000    0.9936521    1.1033308 -0.0013213764    1.4830182 
   30000    1.0106141    1.0845812  0.048019524    1.3015283 
   32000    1.0138237   0.96535384  -0.18328359    1.1659494 
   34000   0.99897229    1.2265577 -0.057168503    1.3064819 
   36000   0.98508691    1.1289173  -0.18839382    1.5336228 
   38000    1.0419001   0.79249301  -0.20846158    1.4200528 
   40000    1.0152017   0.98214979 -0.0067504119    1.3792256 
   42000    1.0113905    1.0421477 -0.047659129    1.3414456 
   44000    1.0201365     1.112008   0.01373301    1.3159903 
   46000     1.018482   0.93142144  -0.10476936    1.3358778 
   48000    1.0362661   0.77862744 -0.073200405    1.2925615 
   50000    1.0200063   0.96817572 -0.082635361    1.2477558 
   52000     1.018602    1.0281262  0.059387055     1.253828 
   54000    1.0465938   0.78372671  -0.04203004    1.2411918 
   56000    1.0376258     1.031501 -0.043675881    1.3662686 
   58000   0.97830162     1.239229  0.033252127    1.2677821 
   60000   0.99938589    1.2023844   0.05306354     1.191899 
   62000     1.010291   0.93962979  0.047429505    1.0726624 
   64000    1.0233048   0.93855809   0.17161686    1.0641676 
   66000    1.0124208    1.0309115 -0.0040419968    1.0550472 
   68000   0.98507874    1.0281731 -0.090367158     1.070317 
   70000    1.0012103    1.0065752   0.11646809    1.2306811 
   72000    1.0257593   0.94487824  0.047164906    1.2402116 
   74000   0.99773444    1.0006634  -0.16947105    1.3458531 
   76000   0.99053502    1.1802621 -0.011315672    1.4050256 
   78000    1.0266873   0.92896952  0.053862201    1.4183056 
   80000    1.0181396    1.0028774   -0.1669873    1.3918642 
   82000    1.0183891    1.0045513   0.12750581    1.3598925 
   84000    1.0054008    1.1361355   0.11127961    1.3235664 
   86000    1.0153982    1.0270658  0.032996007     1.244148 
   88000    1.0089441   0.94065248  -0.14958385    1.2504534 
   90000    1.0090826   0.96386446   0.04002849      1.19906 
   92000   0.98701529    1.0170739  0.048669738     1.230085 
   94000    1.0271895   0.90965645   0.16524668    1.2111807 
   96000    1.0588564   0.64666046 -0.012052311    1.1865422 
   98000      1.01362      1.02233  0.015426298     1.198456 
  100000   0.99253832    1.1498855  -0.11430916    1.1821222 
  102000    1.0260594    0.8604477 -0.038050842    1.1482599 
  104000    1.0248424    1.0639555  -0.08295859    1.1390154 
  106000    1.0069076    1.2491555  0.010334731    1.1352025 
  108000    1.0350323    0.9938777  0.028015622    1.1395354 
  110000    1.0090965    1.0811591 -0.069761835    1.1641264 
  112000   0.98126774    1.2677506   0.03105149    1.1417489 
  114000    1.0053548      1.05943 -0.053492802    1.1435347 
  116000    1.0116531    1.1377687   0.08984011    1.1290702 
  118000    1.0441155   0.94024004  0.069880409    1.1352496 
  120000   0.99682009    1.1603848  -0.09404725    1.2100588 
  122000    1.0155742    1.0078645 -0.027651839     1.173532 
  124000   0.99222072    1.1821546   -0.0308041    1.2037919 
  126000    1.0405098     1.155637  0.030664374    1.1715576 
  128000    1.0187941   0.98070733 0.0059064696    1.2064639 
  130000    1.0399447   0.99686501   0.14875158      1.26474 
  132000    1.0409005    1.0086593  0.021338889    1.2817848 
  134000    1.0476219    0.8026445  0.036028195     1.269031 
  136000    1.0361278   0.82017002   0.12410098    1.2516208 
  138000    1.0118377     1.017853 -0.051473869    1.2497683 
  140000    1.0150827    1.0187598 -0.021626098    1.2422255 
  142000    1.0299632   0.85581133 0.0020789713    1.3028929 
  144000    1.0299864   0.75409682  0.067708051    1.2807235 
  146000    1.0300343   0.95486967  -0.12805174    1.2639701 
  148000   0.99833371    1.0636801 -0.012957113    1.2450247 
  150000    1.0218031    1.0345594 -0.0076210772     1.238176 
  152000    1.0166582     1.000406  0.048913573    1.2350809 
  154000    1.0200436    0.9620376  0.016990704    1.2277908 
  156000    1.0174714   0.97523697 -0.089095058    1.2333756 
  158000    1.0057212   0.98373273   0.10571489    1.2207665 
  160000    1.0116139    1.0531268  0.040970831    1.1908489 
  162000    1.0141586   0.97503702  -0.12255418    1.1835675 
  164000   0.96779259    1.1194358   0.17756759    1.1540165 
  166000    1.0009628    1.1253418  0.050763812     1.141318 
  168000   0.99014049    1.1155831  -0.14569673    1.1317473 
  170000    1.0298577   0.98702864 -0.00084160851    1.1904372 
  172000    1.0202995   0.96163813 0.0045819305    1.1873872 
  174000    1.0359389   0.89018321  0.011677378    1.1807412 
  176000    1.0256185    1.0300041   0.02536302    1.1857003 
  178000    1.0271101    1.0152692  -0.13910986    1.2068771 
  180000    1.0194759   0.87873048  -0.12169124    1.1850476 
  182000    1.0319658    1.0033092 -0.095869229    1.1660609 
  184000    1.0078723    1.2412606 -0.049703306    1.1654829 
  186000    1.0442603   0.79824994 -0.093218879    1.1463494 
  188000    1.0004515   0.90810497 -0.048680818    1.1105332 
  190000     1.000942   0.94373473   0.10613178    1.1009497 
  192000     1.048449   0.97658358  -0.17712897    1.1263395 
  194000    1.0290391   0.98531851 -0.012106089    1.0921536 
  196000    1.0315571    1.1564407  0.057141413    1.0858253 
  198000    1.0142691    1.0606813  0.029671093    1.0716634 
  200000    1.0456713   0.84981128   0.11494717    1.0676611 
  202000    1.0260155    1.0217822 -0.040530429    1.0674862 
  204000   0.99472169    1.1602851 0.0051321303    1.0579412 
  206000    1.0014916    1.0461488 0.0060656173    1.0549157 
  208000    1.0022353    1.0846052  -0.11185825    1.0596996 
  210000     1.015275    1.0276323 -0.030737448    1.0550317 
  212000    1.0039546    1.1104646   0.10845813    1.0540841 
  214000     1.007432     1.024032  -0.11046904    1.0455342 
  216000   0.99740694     1.140278 -0.065900867     1.048484 
  218000    1.0237293   0.94527063  -0.20653618    1.0406664 
  220000    1.0069562    1.1273839 -0.0067054642    1.0387632 
  222000    1.0342064    1.0131146  0.035157231    1.0296557 
  224000     1.003096    1.0550729   0.03305911       1.0335 
  226000    1.0144191    1.0049718  0.042900611    1.0650019 
  228000    1.0268793   0.90872396  -0.17661877    1.0602896 
  230000    1.0237908   0.98063448 -0.029475684    1.0685714 
  232000    1.0069934    1.1044794   0.13426396    1.0662281 
  234000   0.98863378   0.95248555 -0.024211245    1.0765215 
  236000    1.0134171    1.0478432  -0.17292923    1.0525098 
  238000    1.0120921   0.99042234  0.025333354    1.0420108 
  240000    1.0042316    1.1071855  -0.02061948    1.0468243 
  242000    1.0086548    1.0773029  -0.10892118    1.0462304 
  244000    1.0016487    1.0120587  -0.11220572    1.0530018 
  246000    1.0206702   0.96270397  0.076386758    1.0399964 
  248000    1.0106322   0.97979007 -0.056885564    1.0285937 
  250000    1.0521704   0.90240063 -0.098004463    1.0680676 
  252000    1.0031792    1.1298376  -0.12700293    1.0572962 
  254000    1.0023361    1.0397687 -0.042138767     1.055246 
  256000    1.0207399   0.99843942 -0.067694614    1.0678481 
  258000   0.98874431     1.228494  0.040793426    1.0558317 
  260000    1.0183455    1.0188006  -0.17725132    1.0629806 
  262000    1.0018425   0.94317435   0.10076842    1.0548939 
  264000    1.0166318    0.8436724 -0.056681878    1.0488651 
  266000    1.0091103    1.0775158  0.028771667    1.0371622 
  268000    1.0013292   0.95251758 -0.050343862    1.0496861 
  270000   0.99674492    1.1472622  -0.11346408    1.1092918 
  272000    1.0049198    1.0673533 -0.064343803    1.0881727 
  274000    1.0303169   0.97093144 -0.010278759    1.0846913 
  276000    1.0273615   0.84473644 -0.017151036    1.0688783 
  278000    1.0127363    1.2089228 -0.039397817    1.0875618 
  280000   0.98505511    1.1212088  -0.04261016    1.0843387 
  282000    1.0210332   0.93982023  -0.11219324    1.0790461 
  284000    1.0157606    1.0203143 0.0002164565    1.0721431 
  286000    1.0062366    1.0025507  -0.16786234    1.0720064 
  288000   0.98467873    1.2326624 -0.081203997    1.0660396 
  290000    1.0099975   0.88882236 -0.031064103    1.0590327 
  292000    1.0122416    1.0611548 -0.022475529    1.0519549 
  294000    1.0104116    1.0266518  -0.10512697    1.0414083 
  296000    1.0034132    1.0427754 -0.014337433    1.0415291 
  298000    1.0171588   0.92899734   0.10623709    1.0432266 
  300000    1.0280222    1.0524269  0.079178549    1.0534846 
  302000     1.035771   0.87031074  0.029223556    1.0548035 
  304000   0.99817826   0.96586889 -0.092577945     1.051271 
  306000   0.99961879    1.1082249 -0.079054344    1.0495721 
  308000    1.0136108    1.0992365  -0.11696242    1.0384906 
  310000   0.99316114    1.0758087  0.067733542    1.0276102 
  312000    1.0106481   0.99751609  0.096323719    1.0260196 
  314000    1.0069421    1.0474061 -0.0071188531    1.0257001 
  316000    1.0401836   0.81939716 -0.088499972    1.0302389 
  318000    1.0095707    1.1018438 -0.0069997734    1.0318989 
  320000    1.0316135     1.003588  0.010687649    1.0262453 
  322000     1.009186   0.93116391   0.02270494    1.0207195 
  324000    1.0186856    1.0207355 -0.049273034    1.0315045 
  326000    1.0496148    0.9479271 -0.019377803    1.0186608 
  328000    1.0280164   0.83246382 -0.067199824    1.0121899 
  330000    1.0292958   0.96946051 -0.0067323294    1.0106087 
  332000    1.0118055   0.94580297   -0.1158678   0.99982007 
  334000    1.0090884    1.1414243 -0.082638749   0.98931612 
  336000   0.96668553    1.2041384 0.0042176058   0.98213644 
  338000    1.0292409   0.91712359  -0.10674714    1.0014886 
  340000    1.0056353    1.0054878 -0.067790602   0.97639404 
  342000    1.0105034    1.1000009 -0.065106486   0.98781851 
  344000    1.0296097   0.97446628  -0.11031518   0.98121512 
  346000     1.022878    1.0302285 -0.092796664    1.0040982 
  348000    1.0200294   0.84461432  0.001340607    1.0143357 
  350000    0.9942428    1.0974217  0.032976965    1.0066948 
  352000    1.0038173    1.1777572  -0.02105487   0.99841101 
  354000    1.0363725    1.0742789 -0.068095272   0.99311679 
  356000    1.0142211   0.93380261  0.011873553   0.98531527 
  358000   0.99346289    1.2559305   -0.1027067   0.98126142 
  360000   0.99957906    1.0307272 -0.052751638    1.0043971 
  362000    1.0196151    1.1349776  -0.09260849    1.0011441 
  364000    1.0371154   0.88342615   0.12450793   0.99706262 
  366000     1.014625    1.0304514 -0.027977229    0.9921965 
  368000    1.0584324   0.83998131  -0.07933342   0.99525213 
  370000    1.0480268   0.83980605 -0.089536871   0.99539504 
  372000    1.0124627     1.060244   0.14069432   0.99714731 
  374000    1.0319035   0.80898054   0.13773298   0.99196179 
  376000    1.0175987   0.86095756 -0.022196463   0.99034665 
  378000     1.024277   0.96855584 -0.082372168   0.98711506 
  380000    1.0309973   0.91266594 -0.0038718874    1.0004437 
  382000    1.0195474   0.84949163 -0.090011652   0.97877658 
  384000    1.0127199   0.92573997 -0.047436984   0.99568293 
  386000    1.0155482    1.0260345  0.058825776    1.0032397 
  388000    1.0341266    1.0684283  0.042324727    0.9962933 
  390000     1.015419    1.2043476 -0.065809399   0.98978792 
  392000   0.99510423    1.0679104    0.1194931   0.98198405 
  394000   0.99275686    1.1827413  0.064956819    1.0203304 
  396000    1.0004565    1.1524019  -0.12851079    1.0328568 
  398000    1.0230487    1.1653679  0.066552948    1.0356753 
  400000    1.0246668    1.0378562 -0.014987589    1.0388305 
  402000   0.99713302   0.98996019  -0.12440697    1.0369703 
  404000    1.0078626    1.0678616   -0.0361031    1.0292353 
  406000    1.0264278   0.91482461    0.1001659    1.0269674 
  408000   0.99866487    1.1801482 -0.062540579     1.021615 
  410000   0.97734309    1.1861242   0.05416943     1.014162 
  412000    1.0157071    0.9442541   0.22262556    1.0141824 
  414000   0.98254015    1.2581149  0.015246929    1.0085563 
  416000    1.0325598   0.90098178  0.041081387    1.0044668 
  418000    1.0285532   0.82679005  -0.10105529    1.0017654 
  420000    1.0324223   0.95868597  0.024808094   0.99789922 
  422000    1.0056928    1.0690554 -0.024850455    1.0197904 
  424000   0.99482351    1.1228662  0.049501791    1.0272213 
  426000    1.0222594   0.97941801  -0.11968536    1.0186344 
  428000    1.0111263    1.1141009    0.1437415    1.0130656 
  430000   0.98139004    1.0366378  0.067956814    1.0108714 
  432000   0.98613642    1.0119979  0.041509654    1.0033766 
  434000    1.0230324   0.86869314  0.055734923    1.0020727 
  436000    1.0212417    0.8436869 -0.022905431    0.9985587 
  438000    1.0093302   0.97821341  0.023100883   0.99687144 
  440000    1.0419272   0.87856473 -0.020071536   0.99762884 
  442000    1.0172555   0.90164932   0.19704935   0.99904268 
  444000    1.0399087    1.0051297 -0.022213498   0.99616218 
  446000    1.0281756    1.0867446 -0.048363674   0.99230925 
  448000   0.98980118    1.1266212   0.16193455   0.99381525 
  450000    1.0397066    1.0216642 -0.017946472    1.0119634 
  452000    1.0148816    1.0709423 -0.072255226    1.0011103 
  454000   0.97505657    1.1553955 -0.019747328    0.9952685 
  456000    1.0423127   0.93927199    0.1031593    1.0160711 
  458000    1.0185738    0.9317795  -0.14238875    1.0212947 
  460000    1.0254941   0.94237321   0.17279884    1.0176267 
  462000    1.0331624   0.90556647  -0.17064389    1.0197747 
  464000    1.0170281   0.98452898  -0.17212408     1.006159 
  466000    1.0201836    1.0477978 0.0063101913   0.99741201 
  468000   0.99055758      1.19768  -0.04304958   0.99395064 
  470000    1.0140337    1.1042576   0.06483947    1.0006513 
  472000    1.0369845   0.82562513  -0.06621037    1.0320218 
  474000    1.0149565   0.86550007  0.060011486    1.0723558 
  476000    1.0056806   0.99384495 -0.069441814    1.0623019 
  478000    1.0333144   0.91193908 0.0045431056    1.0625281 
  480000    1.0176402   0.90416174 -0.065787627    1.0534142 
  482000   0.99406615    1.1281258   0.15969853    1.0526461 
  484000    1.0119737    1.0284268 -0.020359549    1.0710582 
  486000   0.98481179      1.08347  0.049797547    1.0738962 
  488000    1.0444857   0.87660853 0.0011127729    1.0730464 
  490000    1.0253141   0.92405109  0.070770655    1.0712017 
  492000    1.0167975   0.88249423   0.12097353    1.0689941 
  494000   0.96051412    1.3166559 -0.034841104    1.0721439 
  496000    1.0284614    1.0149666 -0.0055275607    1.0641449 
  498000    1.0107367    1.0406533 -0.030980028    1.0623882 
  500000    0.9902026    1.2232023 -0.038731213    1.0606073 
Loop time of 70.5579 on 1 procs for 500000 steps with 800 atoms

Pair  time (%) = 47.4863 (67.3012)
Neigh time (%) = 11.1177 (15.7568)
Comm  time (%) = 1.90226 (2.69603)
Outpt time (%) = 0.00377345 (0.00534802)
Other time (%) = 10.0479 (14.2406)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    260 ave 260 max 260 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5611 ave 5611 max 5611 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5611
Ave neighs/atom = 7.01375
Neighbor list builds = 59311
Dangerous builds = 0

variable         eta equal v_v11
print            "running average viscosity: ${eta}"
running average viscosity: 1.06060731864499
